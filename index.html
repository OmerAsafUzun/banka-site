<script>

// VERİYİ LOCAL STORAGE'DAN ÇEK
let users = JSON.parse(localStorage.getItem("users")) || {};
let currentUser = localStorage.getItem("currentUser") || null;

// VERİYİ KAYDET
function saveData(){
  localStorage.setItem("users", JSON.stringify(users));
  localStorage.setItem("currentUser", currentUser);
}

// Register
function register(){
  const id = document.getElementById('regId').value;
  const pass = document.getElementById('regPass').value;

  if(!id || !pass){
    alert("Boş bırakma!");
    return;
  }

  if(users[id]){
    alert("Bu ID zaten var!");
  } else {
    users[id] = {pass:pass, balance:0};
    saveData();
    alert("Hesap oluşturuldu!");
  }
}

// Login
function login(){
  const id = document.getElementById('loginId').value;
  const pass = document.getElementById('loginPass').value;

  if(id === "admin" && pass === "admin"){
    currentUser = "admin";
    saveData();
    document.getElementById('loginPanel').style.display='none';
    document.getElementById('adminPanel').style.display='block';
    showAllUsers();
    return;
  }

  if(users[id] && users[id].pass === pass){
    currentUser = id;
    saveData();
    document.getElementById('loginPanel').style.display='none';
    document.getElementById('userPanel').style.display='block';
    updateBalance();
  } else {
    alert("Yanlış giriş!");
  }
}

// BAKİYE GÜNCELLE
function updateBalance(){
  document.getElementById('balance').innerText = users[currentUser].balance;
}

// SATIN AL
function buy(item, price){
  if(users[currentUser].balance >= price){
    users[currentUser].balance -= price;
    saveData();
    updateBalance();
    alert(item + " satın alındı!");
  } else {
    alert("Yeterli bakiye yok!");
  }
}

// ADMIN TÜM KULLANICILARI GÖR
function showAllUsers(){
  const div = document.getElementById('allUsers');
  div.innerHTML = "";

  for(const u in users){
    div.innerHTML += `
      <p>
      ${u} - Bakiye: ${users[u].balance}
      <button onclick="addMoney('${u}')">+20 Para</button>
      </p>
    `;
  }
}

// ADMIN PARA EKLE
function addMoney(user){
  users[user].balance += 20;
  saveData();
  showAllUsers();
}

// SAYFA YENİLENİNCE OTOMATİK GİRİŞ
window.onload = function(){
  if(currentUser){
    document.getElementById('loginPanel').style.display='none';

    if(currentUser === "admin"){
      document.getElementById('adminPanel').style.display='block';
      showAllUsers();
    } else {
      document.getElementById('userPanel').style.display='block';
      updateBalance();
 <!-- VERSION -->
<div class="version">
  W2.3
</div>

</body>
</html>
    }
  }
}

</script>
